<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>Sobre Animado con Audio y Emoji</title>
<style>
  /* Variables */
  :root {
    --envelope-width: 320px;
    --envelope-height: 220px;
    --envelope-bg: #fae5d3;
    --stamp-url: https://i.postimg.cc/FzXN48CZ/stamp.png; /* Cambia aqu√≠ si quieres */
    --letter-bg: #fff6e6;
    --font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
  }

  body {
    font-family: var(--font-family);
    background: #f0e8dd;
    margin: 40px;
    display: flex;
    flex-direction: column;
    align-items: center;
  }

  /* Texto t√≠tulo arriba */
  .title-text {
    font-style: italic;
    font-size: 2.5rem;
    margin-bottom: 20px;
    opacity: 0;
    white-space: nowrap;
    color: #444;
    user-select: none;
  }

  /* Animaci√≥n fadeIn letra por letra */
  .title-text.visible {
    animation: fadeInText 3s forwards;
  }
  @keyframes fadeInText {
    from {opacity: 0;}
    to {opacity: 1;}
  }

  /* Contenedor sobre */
  .envelope {
    --fold-rotate-hover: 180deg;
    --fold-delay-hover: 0.15s;
    --fold-zindex-hover: 10;
    --letter-height-hover: 140px;
    --letter-delay-hover: 0.4s;
    --envelope-transform-hover: translateY(-35px);
    --shadow-transform-hover: rotateY(180deg);
    --evelope-rotate-delay-hover: 0.3s;

    width: var(--envelope-width);
    height: var(--envelope-height);
    position: relative;
    cursor: pointer;
    perspective: 1000px;
    user-select: none;
  }

  /* Evitamos hover para abrir, ahora solo con clase .opened */
  /* Sobre interior */
  .envelope-inner {
    width: 100%;
    height: 100%;
    background: var(--envelope-bg);
    border-radius: 10px;
    position: relative;
    transform-style: preserve-3d;
    transition:
      transform 0.8s cubic-bezier(0.23, 1, 0.32, 1);
    transform-origin: top center;
    box-shadow: 0 10px 15px rgb(0 0 0 / 0.1);
    transform: rotateX(0);
  }

  /* Apertura cuando .opened */
  .envelope.opened .envelope-inner {
    transform: rotateX(-150deg);
    transition-delay: 0.3s;
  }

  /* Solapa */
  .envelope-flap {
    width: 100%;
    height: 100px;
    background: var(--envelope-bg);
    position: absolute;
    top: 0;
    left: 0;
    border-radius: 10px 10px 0 0;
    box-shadow: inset 0 3px 3px rgb(0 0 0 / 0.05);
    transform-origin: bottom center;
    transform-style: preserve-3d;
    transition: transform 0.8s cubic-bezier(0.23, 1, 0.32, 1);
  }

  .envelope.opened .envelope-flap {
    transform: rotateX(180deg);
    transition-delay: 0.15s;
    z-index: 10;
  }

  /* Estampilla */
  .stamp {
    position: absolute;
    top: 15px;
    right: 20px;
    width: 60px;
    height: 60px;
    background: url('https://i.postimg.cc/FzXN48CZ/stamp.png') no-repeat center/contain;
    filter: drop-shadow(0 1px 1px rgba(0,0,0,0.1));
  }

  /* Carta dentro */
  .letter {
    width: 280px;
    height: 140px;
    background: var(--letter-bg);
    position: absolute;
    top: 80px;
    left: 20px;
    border-radius: 5px;
    padding: 15px 20px;
    box-sizing: border-box;
    box-shadow: 0 5px 12px rgb(0 0 0 / 0.1);
    opacity: 0;
    transform: translateY(40px);
    transition: opacity 0.5s ease 0.5s, transform 0.5s ease 0.5s;
    font-size: 1.05rem;
    line-height: 1.4;
    color: #4a4a4a;
    font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
  }

  /* Mostrar carta cuando abierto */
  .envelope.opened .letter {
    opacity: 1;
    transform: translateY(0);
  }

  /* Texto del sobre */
  .from-to {
    position: absolute;
    bottom: 20px;
    left: 20px;
    font-size: 1.1rem;
    font-weight: 600;
    color: #555;
  }
  .from-to span {
    display: block;
    margin-bottom: 3px;
  }

  /* Contenedor emojis lluvia */
  .emoji-rain-container {
    position: fixed;
    top: 0;
    left: 0;
    width: 100vw;
    height: 100vh;
    pointer-events: none;
    overflow: hidden;
    z-index: 9999;
  }

  /* Emoji individual */
  .emoji {
    position: fixed;
    top: -40px;
    user-select: none;
    opacity: 0.8;
    animation-name: fall;
    animation-timing-function: linear;
    animation-fill-mode: forwards;
  }
  @keyframes fall {
    to {
      transform: translateY(110vh);
      opacity: 0;
    }
  }
</style>
</head>
<body>

<!-- Texto t√≠tulo afuera del sobre -->
<div class="title-text" id="titleText">Feliz d√≠a Kla! üåª</div>

<!-- Sobre -->
<div class="envelope" id="envelope" role="button" tabindex="0" aria-label="Abrir sobre">
  <div class="envelope-inner">
    <div class="envelope-flap"></div>
    <div class="stamp"></div>
    <div class="from-to">
      <span>De: Yo merito</span>
      <span>Para: Ti uwu ‚ô•Ô∏è</span>
    </div>
    <div class="letter" id="letterText">
      Yo vi esta flor y pens√© en ti porque es bonita, en realidad a m√≠ no me gusta, pero pens√© que a ti te gustar√≠a, porque t√∫ si eres bonita.
    </div>
  </div>
</div>

<!-- Contenedor para emojis üåª -->
<div class="emoji-rain-container"></div>

<!-- Audio -->
<audio id="loveAudio" src="https://voca.ro/1ingiLX4KcXf/download" preload="auto"></audio>

<script>
  const envelope = document.getElementById('envelope');
  const titleText = document.getElementById('titleText');
  const audio = document.getElementById('loveAudio');
  const emojiContainer = document.querySelector('.emoji-rain-container');

  let hasPlayedAudio = false;
  let raining = false;

  // Mostrar t√≠tulo con fade in letra por letra
  function fadeInTitle(textElem) {
    const text = textElem.textContent;
    textElem.textContent = '';
    let i = 0;
    function addLetter() {
      if(i < text.length) {
        textElem.textContent += text[i];
        i++;
        setTimeout(addLetter, 100);
      }
    }
    addLetter();
    textElem.style.opacity = '1';
  }
  fadeInTitle(titleText);

  // Funci√≥n para iniciar lluvia de emojis üåª
  function startEmojiRain() {
    if (raining) return;
    raining = true;

    setInterval(() => {
      const emoji = document.createElement('div');
      emoji.classList.add('emoji');
      emoji.textContent = 'üåª';
      emoji.style.left = Math.random() * 100 + 'vw';
      emoji.style.fontSize = (Math.random() * 20 + 20) + 'px';
      emoji.style.animationDuration = (Math.random() * 3 + 3) + 's';
      emojiContainer.appendChild(emoji);

      setTimeout(() => emoji.remove(), 6000);
    }, 300);
  }

  // Manejar clic en el sobre para abrir y reproducir audio
  envelope.addEventListener('click', () => {
    // Si ya est√° abierto, no hacer nada
    if (envelope.classList.contains('opened')) return;

    envelope.classList.add('opened');

    if (!hasPlayedAudio) {
      audio.play().catch(e => {
        console.warn('No se pudo reproducir el audio autom√°ticamente:', e);
      });
      hasPlayedAudio = true;
    }

    startEmojiRain();
  });

  // Para accesibilidad: abrir sobre con Enter o Space
  envelope.addEventListener('keydown', (e) => {
    if(e.key === 'Enter' || e.key === ' ') {
      e.preventDefault();
      envelope.click();
    }
  });
</script>

</body>
</html>
